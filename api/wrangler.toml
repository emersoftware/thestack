name = "the-stack-api"
main = "src/index.ts"
compatibility_date = "2025-01-01"
compatibility_flags = ["nodejs_compat"]

# D1 Database binding (local por defecto para desarrollo)
[[d1_databases]]
binding = "DB"
database_name = "the-stack-db"
database_id = "local"

[vars]
ENVIRONMENT = "development"
FRONTEND_URL = "http://localhost:5173"

# ============================================
# Production environment
# Deploy con: npx wrangler deploy --env production
# Test cron local: npx wrangler dev --test-scheduled
# ============================================
[env.production]
name = "the-stack-api"

[[env.production.d1_databases]]
binding = "DB"
database_name = "the-stack-db"
database_id = "2fab040d-8589-4f40-9401-aa4da7cc4d51"

[env.production.vars]
ENVIRONMENT = "production"
FRONTEND_URL = "https://thestack.cl"

[env.production.triggers]
crons = ["*/10 * * * *"]
